<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Machine Learning Study Notes - Regularized Logistic Regression | Mengyang Lin&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="When I was taking Applied Econometrics Course at Duke University,  I learned logistic regression as a regression method, the dependent variable of which is cases such as people smoke or not.  In econo">
<meta property="og:type" content="article">
<meta property="og:title" content="Machine Learning Study Notes - Regularized Logistic Regression">
<meta property="og:url" content="http://sunnylinmy.github.io/2015/06/25/ML-LG/index.html">
<meta property="og:site_name" content="Mengyang Lin's Blog">
<meta property="og:description" content="When I was taking Applied Econometrics Course at Duke University,  I learned logistic regression as a regression method, the dependent variable of which is cases such as people smoke or not.  In econo">
<meta property="og:image" content="http://sunnylinmy.github.io/images/logistic_regression.png">
<meta property="og:updated_time" content="2015-06-29T21:31:37.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Machine Learning Study Notes - Regularized Logistic Regression">
<meta name="twitter:description" content="When I was taking Applied Econometrics Course at Duke University,  I learned logistic regression as a regression method, the dependent variable of which is cases such as people smoke or not.  In econo">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href='//fonts.useso.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
  <link href="//fonts.useso.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css" type="text/css">
  

  

  
    <!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$$$','$$$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

  
</head>
<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/" id="logo"><i class="logo"></i><span class="site-title">Mengyang Lin&#39;s Blog</span></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      
      <nav id="sub-nav">
        <div class="profile" id="profile-nav">
          <a id="profile-anchor" href="javascript:;"><img class="avatar" src="/css/images/Duke Garden_Portrait_square.jpg"><i class="fa fa-caret-down"></i></a>
        </div>
      </nav>
      
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="http://sunnylinmy.github.io"></form>
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
      
        <td><a class="main-nav-link" href="/">Home</a></td>
      
        <td><a class="main-nav-link" href="/archives">Archives</a></td>
      
        <td><a class="main-nav-link" href="/categories">Categories</a></td>
      
        <td><a class="main-nav-link" href="/tags">Tags</a></td>
      
        <td><a class="main-nav-link" href="/about">About</a></td>
      
      <td>
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="http://sunnylinmy.github.io"></form>
      </td>
      </tr>
    </table>
  </div>
</header>
    <div class="outer">
      
        <aside id="profile">
  <div class="inner profile-inner">
  	<div class="base-info profile-block">
		  <img id="avatar" src="/css/images/Duke Garden_Portrait_square.jpg">
      <h2 id="name">Mengyang Lin</h2>
      <h3 id="title"></h3>
      <span id="location"><i class="fa fa-map-marker"></i>Cambridge, Massachusetts</span>
      <a id="follow" href="https://github.com/sunnylinmy/">FOLLOW</a>
  	</div>
    <div class="article-info profile-block">
      <div class="article-info-block">
        5
        <span>posts</span>
      </div>
      <div class="article-info-block">
        5
        <span>tags</span>
      </div>
    </div>
    
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
        
          <td><a href="http://github.com/sunnylinmy/" target="_blank" title="github"><i class="fa fa-github"></i></a></td>
        
          <td><a href="https://www.facebook.com/monica.lin.duke" target="_blank" title="facebook"><i class="fa fa-facebook"></i></a></td>
        
          <td><a href="/atom.xml" target="_blank" title="rss"><i class="fa fa-rss"></i></a></td>
        
        </tr>
      </table>
    </div>
    
  </div>
</aside>
      
      <section id="main"><article id="post-ML-LG" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Machine Learning Study Notes - Regularized Logistic Regression
    </h1>
  

        <div class="article-meta">
          <div class="article-date">
  <i class="fa fa-calendar"></i>
  <a href="/2015/06/25/ML-LG/">
    <time datetime="2015-06-26T01:53:10.000Z" itemprop="datePublished">2015-06-25</time>
  </a>
</div>
          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Learning/">Learning</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>When I was taking Applied Econometrics Course at Duke University,  I learned logistic regression as a regression method, the dependent variable of which is cases such as people smoke or not.  In econometrics modeling, what economists consider most is whether the model makes economic sense or not with maybe omitted variables or endogeneity. However, when dealing with large data sets with handreds or thousands of variables, we need to consider the issue of overfitting, which occurs when the machine learning model describes random error instead of actual relationship.</p>
<p>To solve overfitting, one common method is to regularize model. <a href="https://en.wikipedia.org/wiki/Regularization_(mathematics" target="_blank" rel="external">Regularization</a>). Continuing with gradient descent, to regularize, we can add another term at the tail of original cost function and gradient descent function. Add this term, $$${\lambda \over 2m} \theta^2$$$, to cost function and $$${\lambda \over m } \theta$$$ to gradient function. This is the form of L2 regularization. According to wikipedia, L1 regularization is often preferred because it produces sparse models and thus performs feature selection within the learning algorithm, but since the L1 form is not differentiable, and canâ€™t have a closed form, I use L2 form here.</p>
<p>My regularized cost function originally looks like this, which is also a good example of including for-loop in Matlab(which is bad): </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function [J, grad] = costFunctionReg(theta, X, y, lambda)&#10;&#10;   m = length(y); % number of training examples&#10;   J = 0;&#10;   grad = zeros(size(theta));&#10;   g = sigmoid(X*theta);&#10;   n = length(theta);&#10;&#10;   J = J = (1/m)*sum(-y&#39;*log(g)-(1-y)&#39;*log(1-g)) + lambda/(2*m)*theta(2:n,1)&#39;*theta(2:n,1) ;&#10;   grad(1) = (1/m)*sum(transpose(X(:,1))*(g-y))&#10;&#10;   for i = 2:n&#10;   grad(i) = (1/m)*sum(transpose(X(:,i))*(g-y))+ lambda/m *theta(i);&#10;    end&#10;&#10;end</span><br></pre></td></tr></table></figure>
<p>Since matlab calculates based on matrix, we should avoid for-loop as much as possible. One useful tool to vectorize for loop is to use element-wise multiplication operation (.*) and sum. Modify the above function with vectorization:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function [J, grad] = lrCostFunction(theta, X, y, lambda)&#10;&#10;   m = length(y); % number of training examples&#10;   J = 0;&#10;   grad = zeros(size(theta));&#10;&#10;   J = 1/m * sum(-y.*log(sigmoid(X*theta))-(ones(size(y),1)-y).*log(1-sigmoid(X*theta))) + lambda/(2*m)*theta(2:size(theta))&#39;*theta(2:size(theta));                                                                               &#10;   grad(1)= 1/m * (sigmoid(X*theta)-y)&#39;*X(:,1);&#10;                       &#10;   grad(2:size(theta)) = 1/m * ((sigmoid(X*theta)-y)&#39;*X(:,2:size(theta)))&#39;+ lambda/m*theta(2:size(theta)) ;&#10;&#10;   grad = grad(:);&#10;&#10;end</span><br></pre></td></tr></table></figure>
<p>After completing cost function, we can write in the main.m file to use <a href="http://www.mathworks.com/help/optim/ug/fminunc.html" target="_blank" rel="external">fminunc</a>to calculate $$$\theta$$$ and then predict accuracy on training set:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">initial_theta = zeros(size(X, 2), 1);&#10;lambda = 0.1;&#10;&#10;% Set Options&#10;options = optimset(&#39;GradObj&#39;, &#39;on&#39;, &#39;MaxIter&#39;, 400);&#10;&#10;% Optimize&#10;[theta, J, exit_flag] = ...&#10;&#9;fminunc(@(t)(costFunctionReg(t, X, y, lambda)), initial_theta, options);&#10;&#10;p = predict(theta,X);&#10;mean(double(p==y))*100</span><br></pre></td></tr></table></figure>
<p>The accuracy for this project is 83%. As for logistic regression, the function of predict is like: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function p = predict(theta, X)&#10;&#10;m = size(X, 1); % Number of training examples&#10;p = zeros(m, 1);&#10;for i = 1:m&#10;    if (sigmoid(X(i,:)*theta) &#62;= 0.5)&#10;         p(i)= 1;&#10;    else&#10;         p(i)= 0;&#10;end&#10;                                       &#10;end</span><br></pre></td></tr></table></figure>
<p><img src="/images/logistic_regression.png" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://sunnylinmy.github.io/2015/06/25/ML-LG/" data-id="cibifhjz60000eio9o78zd8uw" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Machine-Learning/">Machine Learning</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/07/01/practice_recursion/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Practice recursion
        
      </div>
    </a>
  
  
    <a href="/2015/06/20/Recycle-Station/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Site Selection of Recycle Station of Nanshan District, Shenzhen, China</div>
    </a>
  
</nav>

  
</article>

</section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">recents</h3>
    <div class="widget">
      <ul id="recent-post" class="">
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/07/01/practice_recursion/" class="thumbnail">
  
    <span style="background-image:url(/images/Sierpinski_1.gif
)" alt="Practice recursion" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/interesting-staff/">interesting staff</a></p>
              <p class="item-title"><a href="/2015/07/01/practice_recursion/" class="title">Practice recursion</a></p>
              <p class="item-date"><time datetime="2015-07-01T22:20:19.000Z" itemprop="datePublished">2015-07-01</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/06/25/ML-LG/" class="thumbnail">
  
    <span style="background-image:url(/images/logistic_regression.png
)" alt="Machine Learning Study Notes - Regularized Logistic Regression" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/Learning/">Learning</a></p>
              <p class="item-title"><a href="/2015/06/25/ML-LG/" class="title">Machine Learning Study Notes - Regularized Logistic Regression</a></p>
              <p class="item-date"><time datetime="2015-06-26T01:53:10.000Z" itemprop="datePublished">2015-06-25</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/06/20/Recycle-Station/" class="thumbnail">
  
    <span style="background-image:url(/images/Nanshan_map.png
)" alt="Site Selection of Recycle Station of Nanshan District, Shenzhen, China" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/Learning/">Learning</a></p>
              <p class="item-title"><a href="/2015/06/20/Recycle-Station/" class="title">Site Selection of Recycle Station of Nanshan District, Shenzhen, China</a></p>
              <p class="item-date"><time datetime="2015-06-20T04:00:00.000Z" itemprop="datePublished">2015-06-20</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/06/10/CCAPM/" class="thumbnail">
  
    <span style="background-image:url(/images/mortgage_1.png
)" alt="Empirical Test of Bond Marketâ€™s CCAPM Based on Asymmetric Exponential Power Distribution" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/Learning/">Learning</a></p>
              <p class="item-title"><a href="/2015/06/10/CCAPM/" class="title">Empirical Test of Bond Marketâ€™s CCAPM Based on Asymmetric Exponential Power Distribution</a></p>
              <p class="item-date"><time datetime="2015-06-10T04:00:00.000Z" itemprop="datePublished">2015-06-10</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/06/02/ML-Gradient-Descent1/" class="thumbnail">
  
    <span style="background-image:url(/images/ML_GD_fig1.png
)" alt="Machine Learning Study Notes - Gradient Descent" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/learning/">learning</a></p>
              <p class="item-title"><a href="/2015/06/02/ML-Gradient-Descent1/" class="title">Machine Learning Study Notes - Gradient Descent</a></p>
              <p class="item-date"><time datetime="2015-06-02T04:00:00.000Z" itemprop="datePublished">2015-06-02</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Learning/">Learning</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/interesting-staff/">interesting staff</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/learning/">learning</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dijkstra/">Dijkstra</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hire/">Hire</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Machine-Learning/">Machine Learning</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/learning-CCAPM-Bond/">learning, CCAPM, Bond</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">tag cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Dijkstra/" style="font-size: 10px;">Dijkstra</a> <a href="/tags/Hire/" style="font-size: 10px;">Hire</a> <a href="/tags/Machine-Learning/" style="font-size: 20px;">Machine Learning</a> <a href="/tags/learning-CCAPM-Bond/" style="font-size: 10px;">learning, CCAPM, Bond</a> <a href="/tags/python/" style="font-size: 10px;">python</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">June 2015</a><span class="archive-list-count">4</span></li></ul>
    </div>
  </div>

  
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 Mengyang Lin<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    <!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$$$','$$$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<script src="//ajax.useso.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>